function a104_0x468b(_0x44a2c4,_0x48bd8d){const _0xe70ec=a104_0xe70e();return a104_0x468b=function(_0x468b0e,_0x13886a){_0x468b0e=_0x468b0e-0xe0;let _0x339ef8=_0xe70ec[_0x468b0e];return _0x339ef8;},a104_0x468b(_0x44a2c4,_0x48bd8d);}const a104_0x1436c4=a104_0x468b;(function(_0x8634f7,_0x54460e){const _0x567397=a104_0x468b,_0x384a7a=_0x8634f7();while(!![]){try{const _0x1d08e5=parseInt(_0x567397(0xfa))/0x1+-parseInt(_0x567397(0x114))/0x2*(parseInt(_0x567397(0xe5))/0x3)+-parseInt(_0x567397(0x126))/0x4*(parseInt(_0x567397(0x104))/0x5)+-parseInt(_0x567397(0x102))/0x6+parseInt(_0x567397(0x108))/0x7*(-parseInt(_0x567397(0xe7))/0x8)+-parseInt(_0x567397(0x112))/0x9+parseInt(_0x567397(0xe0))/0xa;if(_0x1d08e5===_0x54460e)break;else _0x384a7a['push'](_0x384a7a['shift']());}catch(_0x40d697){_0x384a7a['push'](_0x384a7a['shift']());}}}(a104_0xe70e,0xd4266));function a104_0xe70e(){const _0x4348c2=['UNQsS','createWriteStream','stop','Percy\x20config\x20created\x20at\x20','path','XQuYs','VaFqa','createPercyConfig','1152047gzYthX','SHrei','app:exec','join','BROWSERSTACK_TESTHUB_UUID','../../helpers/performance/constants','kOieT','pipe','7419450tEyUvz','nodeRequest','125XXcQFv','exec','fetchPercyToken','flags','7enWOxE','isRunning','DOWNLOAD','close','tneLP','token','IyYKv','AGkcW',':start','child_process','5337432BsNzBZ','debug','36fIKIBI','exec:stop','hVzKH','fJjYB','VAdMz','push','automate','SmAoW','end','./PercyBinary','version','hTfyA','VYUlo','stderr','Percy\x20fetch\x20token\x20success','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','percy.log','percy/healthcheck','91144TGFxej','projectName','winstonLogger','Error\x20creating\x20percy\x20config:\x20','WbGOZ','cCiMz','percyOptions','getBinaryPath','jmyei','ENV_VAR','http://localhost:5338','error','isProcessRunning','tqUjV','46826670gNjYgm','writeFile','GET','PERCY_SERVER_ADDRESS','usBDN','284781PwJiuh','../logger','6862312mrQfxW','SpQPJ','pgtVo','data','../../helpers/testhub/constants','../helper','env','JyCTr','api/app_percy/get_project_token?name=','stringify','exports'];a104_0xe70e=function(){return _0x4348c2;};return a104_0xe70e();}const fs=require('fs'),path=require(a104_0x1436c4(0xf6)),os=require('os'),{spawn}=require(a104_0x1436c4(0x111)),helper=require(a104_0x1436c4(0xec)),logger=require(a104_0x1436c4(0xe6))[a104_0x1436c4(0x128)],{getLogDir}=require(a104_0x1436c4(0xe6)),testHubConstants=require(a104_0x1436c4(0xeb)),PerformanceTester=require('../../helpers/performance/performance-tester'),{PERCY_EVENTS:PerformanceEvents}=require(a104_0x1436c4(0xff)),PercyBinary=require(a104_0x1436c4(0x11d));class Percy{#logfile=path[a104_0x1436c4(0xfd)](getLogDir(),a104_0x1436c4(0x124));#address=process[a104_0x1436c4(0xed)][a104_0x1436c4(0xe3)]||a104_0x1436c4(0x130);#binaryPath=null;#config=null;#proc=null;#isApp=![];['isProcessRunning']=![];constructor(_0x495248){this.#config=_0x495248,!!_0x495248['app']&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x45125e=a104_0x1436c4;if(!this.#binaryPath){const _0x231883=new PercyBinary();PerformanceTester['start'](PerformanceEvents[_0x45125e(0x10a)]),this.#binaryPath=await _0x231883[_0x45125e(0x12d)](this.#config),PerformanceTester[_0x45125e(0x11c)](PerformanceEvents[_0x45125e(0x10a)]);}return this.#binaryPath;}async #sleep(_0x559703){return new Promise(_0x2eeafb=>setTimeout(_0x2eeafb,_0x559703));}async['healthcheck'](){const _0x45e956=a104_0x1436c4,_0x2dc2b5={};_0x2dc2b5[_0x45e956(0x10f)]='GET',_0x2dc2b5[_0x45e956(0xee)]=_0x45e956(0x125);const _0x1ba6b8=_0x2dc2b5;try{const _0x30ba14=await helper[_0x45e956(0x103)](_0x1ba6b8[_0x45e956(0x10f)],_0x1ba6b8[_0x45e956(0xee)],null,null,this.#address);if(_0x30ba14)return!![];}catch(_0x41ba8d){return![];}}async['start'](){const _0x2bd2e6=a104_0x1436c4,_0x54c0e0={'VAdMz':_0x2bd2e6(0xfc),'UNQsS':_0x2bd2e6(0x105),'VYUlo':function(_0x3a8e1f,_0xb3a5e1,_0x45c776,_0x594908){return _0x3a8e1f(_0xb3a5e1,_0x45c776,_0x594908);},'tneLP':'close','IiBWN':'Percy\x20healthcheck\x20successful'},_0x3430e5=await this.#getBinaryPath(),_0x27ac05={};_0x27ac05[_0x2bd2e6(0x107)]='a';const _0x59d4c9=fs[_0x2bd2e6(0xf3)](this.#logfile,_0x27ac05),_0x4d35fc=await this[_0x2bd2e6(0x106)](),_0x2eb078=await this['createPercyConfig']();if(!_0x4d35fc)return![];const _0x4db39c=[(this.#isApp?_0x54c0e0[_0x2bd2e6(0x118)]:_0x54c0e0[_0x2bd2e6(0xf2)])+_0x2bd2e6(0x110)];_0x2eb078&&_0x4db39c[_0x2bd2e6(0x119)]('-c',_0x2eb078);this.#proc=_0x54c0e0[_0x2bd2e6(0x120)](spawn,_0x3430e5,_0x4db39c,{'env':Object['assign'](process[_0x2bd2e6(0xed)],{'PERCY_TOKEN':_0x4d35fc,'TH_BUILD_UUID':process[_0x2bd2e6(0xed)][testHubConstants[_0x2bd2e6(0x12f)][_0x2bd2e6(0xfe)]]})}),this.#proc['stdout'][_0x2bd2e6(0x101)](_0x59d4c9),this.#proc[_0x2bd2e6(0x121)][_0x2bd2e6(0x101)](_0x59d4c9),this[_0x2bd2e6(0x132)]=!![];var _0x4057f2=this;this.#proc['on'](_0x54c0e0[_0x2bd2e6(0x10c)],function(_0x5db63a){_0x4057f2['isProcessRunning']=![];});do{const _0x3d91b1=await this['healthcheck']();if(_0x3d91b1)return logger['debug'](_0x54c0e0['IiBWN']),!![];await this.#sleep(0x3e8);}while(this['isProcessRunning']);return![];}async[a104_0x1436c4(0xf4)](){const _0x3ce807=a104_0x1436c4,_0x362870={'IyYKv':function(_0x59386b,_0x561274){return _0x59386b(_0x561274);},'WbGOZ':function(_0x1e0919,_0x1f4a4b,_0x1a868a){return _0x1e0919(_0x1f4a4b,_0x1a868a);},'kOieT':_0x3ce807(0x115),'usBDN':_0x3ce807(0x10b)},_0x436c3b=await this.#getBinaryPath();return new Promise((_0x521485,_0x196a13)=>{const _0x41f4ba=_0x3ce807,_0x11bcbf={'VaFqa':function(_0x908d5a,_0x3893d5){const _0x1ab5e3=a104_0x468b;return _0x362870[_0x1ab5e3(0x10e)](_0x908d5a,_0x3893d5);}},_0x5dbbcf=_0x362870[_0x41f4ba(0x12a)](spawn,_0x436c3b,[_0x362870[_0x41f4ba(0x100)]]);_0x5dbbcf['on'](_0x362870[_0x41f4ba(0xe4)],_0x204f75=>{const _0x28b937=_0x41f4ba;this[_0x28b937(0x132)]=![],_0x11bcbf[_0x28b937(0xf8)](_0x521485,_0x204f75);});});}[a104_0x1436c4(0x109)](){return this['isProcessRunning'];}async[a104_0x1436c4(0x106)](){const _0x120e96=a104_0x1436c4,_0x4f0b4a={};_0x4f0b4a[_0x120e96(0x117)]='app',_0x4f0b4a[_0x120e96(0x11b)]=_0x120e96(0x11a),_0x4f0b4a[_0x120e96(0xfb)]=_0x120e96(0xe2),_0x4f0b4a[_0x120e96(0xe8)]=_0x120e96(0x122);const _0x36b7bf=_0x4f0b4a,_0x4e5f4c=this.#config[_0x120e96(0x127)];try{const _0x1e5450=this.#isApp?_0x36b7bf[_0x120e96(0x117)]:_0x36b7bf[_0x120e96(0x11b)],_0x4a9221=await helper[_0x120e96(0x103)](_0x36b7bf[_0x120e96(0xfb)],_0x120e96(0xef)+_0x4e5f4c+'&type='+_0x1e5450,{},this.#config),_0x114695=_0x4a9221[_0x120e96(0xea)];return logger[_0x120e96(0x113)](_0x36b7bf[_0x120e96(0xe8)]),_0x114695[_0x120e96(0x10d)];}catch(_0x145c3d){return logger[_0x120e96(0x131)](_0x120e96(0x123)+_0x145c3d),null;}}async[a104_0x1436c4(0xf9)](){const _0x51e4f4=a104_0x1436c4,_0x46902b={'tqUjV':function(_0x4a3c9a,_0x4c16ad){return _0x4a3c9a(_0x4c16ad);},'jmyei':function(_0x3c0a3c,_0x3a57c7){return _0x3c0a3c+_0x3a57c7;},'hTfyA':_0x51e4f4(0xf5),'MJktm':'percy.json'};if(!this.#config[_0x51e4f4(0x12c)])return null;const _0x363f1f=path[_0x51e4f4(0xfd)](os['tmpdir'](),_0x46902b['MJktm']),_0x565e40=this.#config[_0x51e4f4(0x12c)];return!_0x565e40[_0x51e4f4(0x11e)]&&(_0x565e40[_0x51e4f4(0x11e)]='2'),new Promise((_0x1aaa23,_0x2b3cea)=>{const _0x1fd941=_0x51e4f4,_0x276c94={'pgtVo':function(_0x2f0ecb,_0x450a55){const _0x12353c=a104_0x468b;return _0x46902b[_0x12353c(0x133)](_0x2f0ecb,_0x450a55);},'cCiMz':function(_0x1127a7,_0x179e5e){const _0xa5c8c9=a104_0x468b;return _0x46902b[_0xa5c8c9(0x12e)](_0x1127a7,_0x179e5e);},'hVzKH':_0x46902b[_0x1fd941(0x11f)],'XQuYs':function(_0x2ffda4,_0x4df61e){const _0x51a836=_0x1fd941;return _0x46902b[_0x51a836(0x133)](_0x2ffda4,_0x4df61e);}};fs[_0x1fd941(0xe1)](_0x363f1f,JSON[_0x1fd941(0xf0)](_0x565e40),_0x177c0a=>{const _0x4f6186=_0x1fd941;_0x177c0a&&(logger[_0x4f6186(0x131)](_0x4f6186(0x129)+_0x177c0a),_0x276c94[_0x4f6186(0xe9)](_0x1aaa23,null)),logger[_0x4f6186(0x113)](_0x276c94[_0x4f6186(0x12b)](_0x276c94[_0x4f6186(0x116)],_0x363f1f)),_0x276c94[_0x4f6186(0xf7)](_0x1aaa23,_0x363f1f);});});}}module[a104_0x1436c4(0xf1)]=Percy;