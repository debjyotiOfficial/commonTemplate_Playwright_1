const a82_0x32f3c0=a82_0x25bb;function a82_0x25bb(_0x4a1ecf,_0x485b4d){const _0x38de98=a82_0x38de();return a82_0x25bb=function(_0x25bbfb,_0x5c1207){_0x25bbfb=_0x25bbfb-0x13c;let _0x3e4da2=_0x38de98[_0x25bbfb];return _0x3e4da2;},a82_0x25bb(_0x4a1ecf,_0x485b4d);}(function(_0x145212,_0x47c401){const _0x1e8aed=a82_0x25bb,_0x1cc932=_0x145212();while(!![]){try{const _0xfc999d=parseInt(_0x1e8aed(0x19a))/0x1*(-parseInt(_0x1e8aed(0x179))/0x2)+parseInt(_0x1e8aed(0x142))/0x3*(parseInt(_0x1e8aed(0x154))/0x4)+-parseInt(_0x1e8aed(0x18b))/0x5+-parseInt(_0x1e8aed(0x156))/0x6+-parseInt(_0x1e8aed(0x163))/0x7*(-parseInt(_0x1e8aed(0x182))/0x8)+-parseInt(_0x1e8aed(0x16f))/0x9+parseInt(_0x1e8aed(0x180))/0xa*(parseInt(_0x1e8aed(0x197))/0xb);if(_0xfc999d===_0x47c401)break;else _0x1cc932['push'](_0x1cc932['shift']());}catch(_0x5840fa){_0x1cc932['push'](_0x1cc932['shift']());}}}(a82_0x38de,0x56cd5));const os=require('os'),fs=require('fs'),path=require('path'),util=require(a82_0x32f3c0(0x160)),BrowserstackCLI=require(a82_0x32f3c0(0x165)),https=require(a82_0x32f3c0(0x191)),http=require('http'),AutomationFramework=require(a82_0x32f3c0(0x170)),PlaywrightDriverModule=require(a82_0x32f3c0(0x192)),TestInfo=require(a82_0x32f3c0(0x14b)),TestFrameworkConstants=require('./framework/constants/testFrameworkConstants'),{createClassLogger}=require('../../helpers/classLogger.js');function a82_0x38de(){const _0x18f789=['caVxl','LUfbu','finish','NKuLz','debug','logger','recursive','268728RHXKZT','testhubConfig','2955348vqwieq','mkdirSync','https://','UErnm','CEKDu','basename','size','File\x20downloaded\x20to:\x20%s','homedir','wWVTv','util','toFixed','enOuI','2352nypzKN','vqrUM','./browserstackCLI','zuTWY','XsEzp','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','testInfo','buildHashedId','TestHubModule','KEY_FILE_PATH','getInstance','existsSync','1650060hPkTsK','./framework/automationFramework','WHuXt','HZIMO','statSync','KEY_FILE_SIZE','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','yxaCf','AcZZM','unlinkSync','16zkEdKH','KEY_TEST_ATTACHMENTS','uploadAttachmentsManager','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','XrmBE','rmSync','trackFile','11182350QSPhug','dkqwv','16832lDRoSv','LjjIs','startsWith','JWPpR','message','error','http://','uploadAttachments','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','3279370AzLbcr','afMee','eLaJJ','TestLevel','join','Ntuwo','https','./modules/playwrightDriverModule','ZCSAo','Attachment\x20recevied\x20for\x20path:\x20%s','FcRoU','PZnao','11YompsI','statusCode','.browserstack','59222MubSlv','DQoHg','QRqRd','force','qRGPE','MmlQJ','fAjEA','BuildLevel','KEY_FILE_NAME','abCBY','15HpmtKo','close','createWriteStream','Created\x20folder:\x20%s','KEY_FILE_LEVEL','OARAD','currentTest','__workerDetails','modules','./TestInfo','format'];a82_0x38de=function(){return _0x18f789;};return a82_0x38de();}class uploadAttachmentsManager{static [a82_0x32f3c0(0x152)]=createClassLogger(a82_0x32f3c0(0x17b));static[a82_0x32f3c0(0x189)](_0x11483c,_0xb4d307=![]){const _0x5cad80=a82_0x32f3c0,_0x1e6530={};_0x1e6530[_0x5cad80(0x14d)]=function(_0x1acda0,_0x3b47d7){return _0x1acda0/_0x3b47d7;},_0x1e6530[_0x5cad80(0x13d)]=function(_0x390136,_0xc64496){return _0x390136*_0xc64496;},_0x1e6530[_0x5cad80(0x13e)]=function(_0x57e254,_0x4129a3){return _0x57e254>_0x4129a3;},_0x1e6530[_0x5cad80(0x181)]='Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.',_0x1e6530[_0x5cad80(0x19b)]=_0x5cad80(0x15d),_0x1e6530[_0x5cad80(0x13c)]=function(_0x498167,_0x16df25){return _0x498167===_0x16df25;},_0x1e6530[_0x5cad80(0x141)]=_0x5cad80(0x14f),_0x1e6530[_0x5cad80(0x196)]='Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload',_0x1e6530[_0x5cad80(0x195)]='Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload',_0x1e6530['zuTWY']=_0x5cad80(0x194),_0x1e6530[_0x5cad80(0x190)]=_0x5cad80(0x199),_0x1e6530[_0x5cad80(0x183)]=_0x5cad80(0x18a),_0x1e6530[_0x5cad80(0x14e)]='Created\x20.browserstack\x20folder\x20at:\x20%s',_0x1e6530[_0x5cad80(0x18c)]=_0x5cad80(0x145),_0x1e6530[_0x5cad80(0x167)]=function(_0xa5364f,_0x56b474){return _0xa5364f===_0x56b474;},_0x1e6530[_0x5cad80(0x18d)]='Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.',_0x1e6530['AcZZM']=_0x5cad80(0x158),_0x1e6530[_0x5cad80(0x162)]=_0x5cad80(0x188),_0x1e6530[_0x5cad80(0x15f)]=_0x5cad80(0x187),_0x1e6530[_0x5cad80(0x150)]=_0x5cad80(0x168),_0x1e6530[_0x5cad80(0x15a)]=function(_0xf85bda,_0x193833){return _0xf85bda>_0x193833;},_0x1e6530['QRqRd']='File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.';const _0x3adb35=_0x1e6530;this[_0x5cad80(0x152)][_0x5cad80(0x151)](util[_0x5cad80(0x14c)](_0x3adb35[_0x5cad80(0x166)],_0x11483c));const _0x68425c=os[_0x5cad80(0x15e)](),_0x75a4d3=path['join'](_0x68425c,_0x3adb35[_0x5cad80(0x190)]);!fs['existsSync'](_0x75a4d3)&&(this['logger'][_0x5cad80(0x151)](util[_0x5cad80(0x14c)](_0x3adb35[_0x5cad80(0x183)],_0x75a4d3)),fs[_0x5cad80(0x157)](_0x75a4d3),this['logger'][_0x5cad80(0x151)](util['format'](_0x3adb35[_0x5cad80(0x14e)],_0x75a4d3)));const _0x1f7ee3=BrowserstackCLI[_0x5cad80(0x16d)]()[_0x5cad80(0x14a)][_0x5cad80(0x16b)]?.[_0x5cad80(0x155)]?.['toObject']()?.[_0x5cad80(0x16a)],_0x131daf=path[_0x5cad80(0x18f)](_0x75a4d3,_0x1f7ee3);!fs[_0x5cad80(0x16e)](_0x131daf)&&(fs[_0x5cad80(0x157)](_0x131daf),this[_0x5cad80(0x152)][_0x5cad80(0x151)](util[_0x5cad80(0x14c)](_0x3adb35[_0x5cad80(0x18c)],_0x131daf)));if(_0x3adb35[_0x5cad80(0x167)](_0x11483c['trim'](),'')){this[_0x5cad80(0x152)][_0x5cad80(0x151)](util['format'](_0x3adb35[_0x5cad80(0x18d)]));return;}if(_0x11483c[_0x5cad80(0x184)](_0x3adb35[_0x5cad80(0x177)])||_0x11483c[_0x5cad80(0x184)](_0x3adb35[_0x5cad80(0x162)])){const _0x2bc67d=_0x11483c[_0x5cad80(0x184)](_0x3adb35['AcZZM'])?https:http,_0x4d7666=path['basename'](_0x11483c),_0xbfa1b9=path[_0x5cad80(0x18f)](_0x131daf,_0x4d7666),_0x29b0de=fs[_0x5cad80(0x144)](_0xbfa1b9);_0x2bc67d['get'](_0x11483c,_0x3fb6e3=>{const _0x352ea4=_0x5cad80,_0x49b591={'WHuXt':function(_0x3e41fa,_0x3c45b7){const _0x156c8b=a82_0x25bb;return _0x3adb35[_0x156c8b(0x14d)](_0x3e41fa,_0x3c45b7);},'KijHo':function(_0x158855,_0x73b215){const _0x34bac8=a82_0x25bb;return _0x3adb35[_0x34bac8(0x13d)](_0x158855,_0x73b215);},'JWPpR':function(_0x5b61cb,_0x3f47d0){return _0x3adb35['fAjEA'](_0x5b61cb,_0x3f47d0);},'JpZaC':_0x3adb35[_0x352ea4(0x181)],'ZTkVt':_0x3adb35[_0x352ea4(0x19b)]};if(_0x3adb35['qRGPE'](_0x3fb6e3[_0x352ea4(0x198)],0xc8))_0x3fb6e3['pipe'](_0x29b0de),_0x29b0de['on'](_0x3adb35['abCBY'],()=>{const _0x344540=_0x352ea4;_0x29b0de['close']();const _0x23971e=fs[_0x344540(0x173)](_0xbfa1b9),_0x390c49=_0x49b591[_0x344540(0x171)](_0x23971e[_0x344540(0x15c)],_0x49b591['KijHo'](0x400,0x400));if(_0x49b591[_0x344540(0x185)](_0x390c49,0x64)){this[_0x344540(0x152)][_0x344540(0x151)](util[_0x344540(0x14c)](_0x49b591['JpZaC'],_0x390c49[_0x344540(0x161)](0x2))),fs[_0x344540(0x178)](_0xbfa1b9);return;}this['logger'][_0x344540(0x151)](util['format'](_0x49b591['ZTkVt'],_0xbfa1b9)),uploadAttachmentsManager[_0x344540(0x17f)](_0xbfa1b9,_0xb4d307);});else{this[_0x352ea4(0x152)]['debug'](util[_0x352ea4(0x14c)](_0x3adb35['PZnao'],_0x3fb6e3[_0x352ea4(0x198)])),_0x29b0de['close'](),fs[_0x352ea4(0x178)](_0xbfa1b9);return;}})['on'](_0x3adb35['wWVTv'],_0x4a5792=>{const _0x3e2fa2=_0x5cad80;this[_0x3e2fa2(0x152)][_0x3e2fa2(0x151)](util[_0x3e2fa2(0x14c)](_0x3adb35[_0x3e2fa2(0x195)],_0x4a5792[_0x3e2fa2(0x186)])),_0x29b0de[_0x3e2fa2(0x143)](),fs['unlinkSync'](_0xbfa1b9);return;});}else{if(!fs['existsSync'](_0x11483c)){this[_0x5cad80(0x152)][_0x5cad80(0x151)](util[_0x5cad80(0x14c)](_0x3adb35[_0x5cad80(0x150)],_0x11483c));return;}const _0x1496eb=fs['statSync'](_0x11483c),_0x56fb0f=_0x3adb35['caVxl'](_0x1496eb[_0x5cad80(0x15c)],_0x3adb35[_0x5cad80(0x13d)](0x400,0x400));if(_0x3adb35[_0x5cad80(0x15a)](_0x56fb0f,0x64)){this[_0x5cad80(0x152)][_0x5cad80(0x151)](util[_0x5cad80(0x14c)](_0x3adb35[_0x5cad80(0x19c)],_0x56fb0f[_0x5cad80(0x161)](0x2)));return;}const _0x33f364=path[_0x5cad80(0x15b)](_0x11483c),_0x315cff=path['join'](_0x131daf,_0x33f364);fs['copyFileSync'](_0x11483c,_0x315cff),uploadAttachmentsManager[_0x5cad80(0x17f)](_0x315cff,_0xb4d307);}}static[a82_0x32f3c0(0x17f)](_0x52692f,_0x12872c){const _0x309e1b=a82_0x32f3c0,_0x56ad91={};_0x56ad91[_0x309e1b(0x176)]=_0x309e1b(0x13f),_0x56ad91[_0x309e1b(0x193)]=_0x309e1b(0x18e),_0x56ad91[_0x309e1b(0x172)]=_0x309e1b(0x175),_0x56ad91[_0x309e1b(0x17d)]=_0x309e1b(0x17c);const _0x54e793=_0x56ad91;try{const _0x57b589=global[_0x309e1b(0x149)]?.[_0x309e1b(0x148)]?.[_0x309e1b(0x169)],_0x5d7050=TestInfo['getTestIdentifierFromTestInfo'](_0x57b589,_0x57b589?.['retry']),_0x13fff7=TestInfo['getTestDetails'](_0x5d7050),_0x4478af=_0x13fff7[TestFrameworkConstants['KEY_TEST_ATTACHMENTS']]||{};_0x4478af[_0x52692f]={[TestFrameworkConstants[_0x309e1b(0x174)]]:fs[_0x309e1b(0x173)](_0x52692f)[_0x309e1b(0x15c)],[TestFrameworkConstants[_0x309e1b(0x140)]]:path['basename'](_0x52692f),[TestFrameworkConstants[_0x309e1b(0x16c)]]:_0x52692f,[TestFrameworkConstants[_0x309e1b(0x146)]]:_0x12872c?_0x54e793[_0x309e1b(0x176)]:_0x54e793[_0x309e1b(0x193)]},_0x13fff7[TestFrameworkConstants[_0x309e1b(0x17a)]]=_0x4478af,TestInfo['setTestDetails'](_0x5d7050,_0x13fff7),this[_0x309e1b(0x152)][_0x309e1b(0x151)](util[_0x309e1b(0x14c)](_0x54e793[_0x309e1b(0x172)],_0x52692f));}catch(_0xe85c6d){this[_0x309e1b(0x152)][_0x309e1b(0x151)](util[_0x309e1b(0x14c)](_0x54e793[_0x309e1b(0x17d)],_0xe85c6d[_0x309e1b(0x186)]));}}static['clearAttachments'](){const _0x58d9d1=a82_0x32f3c0,_0x44d43e={};_0x44d43e['UErnm']=_0x58d9d1(0x199),_0x44d43e[_0x58d9d1(0x147)]='No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s',_0x44d43e[_0x58d9d1(0x164)]='Cleared\x20attachment\x20folder';const _0x347fe1=_0x44d43e,_0x1f2b5a=os[_0x58d9d1(0x15e)](),_0x4a45de=path[_0x58d9d1(0x18f)](_0x1f2b5a,_0x347fe1[_0x58d9d1(0x159)]);if(!fs[_0x58d9d1(0x16e)](_0x4a45de))return;const _0x3f613b=BrowserstackCLI[_0x58d9d1(0x16d)]()['modules'][_0x58d9d1(0x16b)]?.[_0x58d9d1(0x155)]?.['toObject']()?.[_0x58d9d1(0x16a)],_0x5f176f=_0x3f613b?path['join'](_0x4a45de,_0x3f613b):null;if(!_0x5f176f||!fs[_0x58d9d1(0x16e)](_0x5f176f)){this[_0x58d9d1(0x152)][_0x58d9d1(0x151)](util[_0x58d9d1(0x14c)](_0x347fe1[_0x58d9d1(0x147)],_0x3f613b));return;}const _0x47d94f={};_0x47d94f[_0x58d9d1(0x153)]=!![],_0x47d94f[_0x58d9d1(0x19d)]=!![],fs[_0x58d9d1(0x17e)](_0x5f176f,_0x47d94f),this[_0x58d9d1(0x152)][_0x58d9d1(0x151)](util[_0x58d9d1(0x14c)](_0x347fe1['vqrUM']));}}module['exports']=uploadAttachmentsManager;